# ==============================================================================
# WINDOW RULES (Unified Syntax)
# ==============================================================================

# --- Dwindle Layout Settings ---
dwindle {
    pseudotile = true
    preserve_split = true
}

# --- Terminal Opacity ---
# Anonymous rules for simple class matching
windowrule = match:class kitty, opacity 0.85 override 0.85 override
windowrule = match:class Alacritty, opacity 0.85 override 0.85 override

# --- Utility Windows ---
windowrule = match:class pavucontrol, float on
windowrule = match:class pavucontrol, center on
windowrule = match:class nm-connection-editor, float on

# --- Named Rule: Picture-in-Picture ---
# The 'name' must be the first key in the block
windowrule {
    name = picture-in-picture
    match:title = ^Picture-in-Picture$
    float = on
    pin = on
}

# --- Smart Gaps (The Correct Way) ---
# Since gaps are not window effects, we define a workspace rule.
# 'w' matches any workspace that has only one window (tiled).
workspace = w, gapsout:0, gapsin:0

# We can still use windowrule to remove borders/rounding when a window is tiled alone
windowrule = match:float 0, border_size 0
windowrule = match:float 0, rounding 0

# ==============================================================================
# LAYER RULES (UI Components)
# ==============================================================================

# Rofi Launcher
layerrule = blur on, match:namespace rofi
layerrule = ignore_alpha 0.2, match:namespace rofi

# Waybar Status Bar
layerrule = blur on, match:namespace waybar
layerrule = ignore_alpha 0.1, match:namespace waybar

# Notification Center (SwayNC)
layerrule = blur on, match:namespace swaync-control-center
layerrule = blur on, match:namespace swaync-notification-window
layerrule = ignore_alpha 0.1, match:namespace swaync-control-center
layerrule = ignore_alpha 0.1, match:namespace swaync-notification-window